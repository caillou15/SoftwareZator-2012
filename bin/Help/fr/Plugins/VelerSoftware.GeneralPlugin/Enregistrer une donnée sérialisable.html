<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Action : Enregistrer une donnée sérialisable</title>
	<script type="text/javascript" src="../../../shCore.js"></script>
	<script type="text/javascript" src="../../../shBrushVb.js"></script>
	<link type="text/css" rel="stylesheet" href="../../../shCoreDefault.css"/>
	<link type="text/css" rel="stylesheet" href="../../../style.css"/>
	<script type="text/javascript">SyntaxHighlighter.all();</script>
</head>

<body>

<p class="title">Action : Enregistrer une donnée sérialisable</p>
	<p>Cette action permet de créer un nouveau fichier de donnée sérialisable sur le disque dur.</p>
	<p class="msg_info"><b>Qu'est-ce que la sérialisation :</b> C'est un procéder qui permet d'enregistrer la valeur complète d'une variable, sous une forme crypté, dans un fichier, et de pouvoir la réouvrir tel qu'elle était lors de son enregistrement, après avoir quitté et relancé votre logiciel par exemple.</p>
	<p class="msg_info"><b>Information :</b> Pour ouvrir un fichier dont la donnée a été sérialisé, utilisez l'action <a href="Ouvrir un fichier sérialisé.html" target="_blank">Ouvrir un fichier sérialisé</a>.</p>
	<p class="msg_info"><b>Information :</b> Pour vérifier que le fichier n'existe pas déjà, utilisez l'action <a href="Déterminer si un fichier existe.html" target="_blank">Déterminer si un fichier existe</a>.</p>
	<p class="msg_info"><b>Information :</b> Pour enregistrer un fichier texte, utilisez l'action <a href="Créer un fichier texte.html" target="_blank">Créer un fichier texte</a>.</p>
	
	<p class="title">Paramètres</p>
	<table>
		<tr>
			<th>Paramètres</th>
			<th>Descriptions</th>
		</tr>
		<tr>
			<td>Nom complet du fichier à créer</td>
			<td>Doit être égale au chemin complet où votre fichier devra être créé.</td>
		</tr>  
		<tr class="bg">
			<td>Ne pas enregistrer si le fichier existe déjà</td>
			<td>En cochant ce paramètre, si le fichier spécifié dans le paramètre précédent existe déjà, alors l'action sera annulé. L'enregistrement ne sera pas effectué.</td>
		</tr>
		<tr>
			<td>Variable dont la donnée sérialisable sera enregistrée</td>
			<td>Doit être égale à la variable dont on enregistrera la valeur dans le fichier spécifié. On considère que cette valeur est une donnée sérialisable.</td>
		</tr> 
		<tr class="bg">
			<td>Variable recevant le résultat de l'enregistrement (facultatif)</td>
			<td>Doit être égale à la variable (non tableau) recevant une valeur indiquant si l'enregistrement a réussi ou non.</td>
		</tr>
	</table>
	<p class="msg_warning"><b>Erreur à ne pas commettre :</b> Pour le paramètre <i>"Nom complet du fichier à créer"</i>, vous ne pouvez pas utiliser des ressources du projet de type Image et de type Autre. Seule des ressources de type Texte peuvent être utilisées.</p>
	<p class="msg_warning"><b>Erreur à ne pas commettre :</b> Si vous utilisez dans variables dans le paramètre <i>"Nom complet du fichier à créer"</i>, assurez-vous que le type de la valeur de chacune de ces variables soit du texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>), ou bien une valeur de type numérique (<a href="http://msdn.microsoft.com/fr-fr/library/06bkb8w2.aspx" target="_blank" title="Lien vers MSDN">Integer</a>, <a href="http://msdn.microsoft.com/fr-fr/library/system.decimal.aspx" target="_blank" title="Lien vers MSDN">Decimal</a>, <a href="http://msdn.microsoft.com/fr-fr/library/system.double.aspx" target="_blank" title="Lien vers MSDN">Double</a>). En effet, seul du texte peut être utilisé dans ce paramètre.<br />
	<b>Note :</b> Pour vérifier le type d'une valeur, utilisez l'action <a href="Obtenir le type d'une variable.html" target="_blank">Obtenir le type d'une variable</a>, dans la catégorie Variables.</p>
    <p class="msg_warning"><b>Erreur à ne pas commettre :</b> Faites attention à ce que le type de la valeur de la variable spécifiée dans le paramètre <i>"Variable dont la donnée sérialisable sera enregistrée"</i> soit une donnée sérialisable. En outre, il faut la valeur de cette variable ai été initialisé par l'action <a href="Assigner une nouvelle donnée sérialisable.html" target="_blank">Assigner une nouvelle donnée sérialisable</a>. Pour vérifier le type d'une valeur, utilisez l'action <a href="Obtenir le type d'une variable.html" target="_blank">Obtenir le type d'une variable</a>, dans la catégorie Variables.</p>

	<p class="title">Valeur retournée</p>    
	<p>La valeur retournée est déterminée par la réussite de l'enregistrement ou non. Elle sera enregistrée dans la variable définit dans le paramètre <i>"Variable recevant le résultat"</i>. Cette valeur est de type Vrai/Faux (<a href="http://msdn.microsoft.com/fr-fr/library/system.boolean%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">Boolean</a>).</p>
	<table>
		<tr>
			<th>Résultat de l'enregistrement</th>
			<th>Valeurs retournées</th>
		</tr>
		<tr>
			<td>Réussi</td>
			<td>True</td>
		</tr>
		<tr class="bg">
			<td>Echoué</td>
			<td>False</td>
		</tr>
	</table>

	<p class="title">Code Visual Basic.Net généré par SoftwareZator</p>
    <p>Code généré si le paramètre <i>"Ne pas enregistrer si le fichier existe déjà"</i> est coché :</p>
	<pre class="brush: vbnet; toolbar: false;">
VelerSoftware_GeneralPlugin.Serialize("Votre fichier.bin", Variable_A_Enregistrer, False)

	</pre>
    <p>Code généré si le paramètre <i>"Ne pas enregistrer si le fichier existe déjà"</i> est coché et qu'une variable recevant le résultat a été spécifiée :</p>
	<pre class="brush: vbnet; toolbar: false;">
Votre_Variable = VelerSoftware_GeneralPlugin.Serialize("Votre fichier.bin", Variable_A_Enregistrer, True)

	</pre>

	<a id="debug" class="debug"></a><p class="title">Erreurs d'exécutions</p>
    <p>Il arrive qu'un programme informatique rencontre un problème durant son exécution. Souvent, un message d'erreur est alors affiché. Le tableau ci-dessous vous permet de déterminer pourquoi l'erreur que vous rencontrez s'affiche et comment la corriger :</p>
	<table>
		<tr>
			<th>Types d'erreurs</th>
			<th>Descriptions</th>
			<th>Resolutions</th>
		</tr>
		<tr>
			<td>System.InvalidCastException</td>
			<td>Cette erreur se produit lorsque la valeur du paramètre <i>"Nom complet du fichier à créer"</i> n'est pas du texte. Souvent, le problème est causé par une variable utilisé dans ce paramètre et qui ont une valeur autre que du texte.</td>
			<td>Pour corriger cette erreur, vérifiez que toutes les valeurs impliquées dans ce paramètre soit bien de type Texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>) et faites les modifications nécessaires pour que ces valeurs soit du texte. Pour cela, utilisez les actions <a href="Obtenir le type d'une variable.html" target="_blank">Obtenir le type d'une variable</a>, <a href="Convertir la valeur d'une variable.html" target="_blank">Convertir la valeur d'une variable</a></td>
        </tr>
		<tr class="bg">
			<td>System.ArgumentException<br />ou<br />System.NotSupportedException</td>
			<td>Cette erreur se produit lorsque la valeur du paramètre <i>"Nom complet du fichier à créer"</i> est nulle, ou contient le signe deux-points (:) ou une barre oblique (\ ou /). C'est caractères ne peuvent être utilisés que pour spécifier un disque dur et un fichier (C:\Un fichier\), mais en aucun cas pour le <u>nom</u> d'un fichier ou dossier.</td>
			<td>Pour corriger cette erreur, vérifiez que le nom du fichier à créer ne soit pas vide et ne contient pas le signe deux-points (:) ou une barre oblique (\ ou /).</td>
        </tr>
		<tr>
			<td>System.ArgumentNullException</td>
			<td>Cette erreur se produit lorsque la valeur du paramètre <i>"Nom complet du fichier à créer"</i> est vide. Pour créer un fichier, vous devez impérativement spécifier le chemin complet du fichier à créer.</td>
			<td>Pour corriger cette erreur, vérifiez que ce paramètre ne soit pas vide.</td>
        </tr>
		<tr class="bg">
			<td>System.IO.DirectoryNotFoundException<br />ou<br />System.IO.FileNotFoundException</td>
			<td>Cette erreur se produit lorsque le chemin spécifié dans le paramètre <i>"Nom complet du fichier à créer"</i> est introuvable sur le disque dur. C'est-à-dire, que le dossier dans lequel le fichier sera créé n'existe pas.</td>
			<td>Pour corriger cette erreur, vérifiez que le chemin vers le fichier à créer soit correcte, et vérifiez que le dossier parent existe avec l'action <a href="Déterminer si un dossier existe.html" target="_blank">Déterminer si un dossier existe</a>.</td>
        </tr>
		<tr>
			<td>System.IO.IOException</td>
			<td>Cette erreur se produit lorsque le fichier spécifié dans le paramètre <i>"Nom complet du fichier à créer"</i> est déjà utilisé par un processus. Vous ne pouvez pas écrire dans un fichier qui est déjà utilisé par un autre logiciel (ou bien le votre, en parallèle).</td>
			<td>Pour corriger cette erreur, vérifiez que ce fichier ne soit pas utilisé par une autre fonction de votre logiciel au même moment que l'exécution de cette action.</td>
        </tr>
		<tr class="bg">
			<td>System.IO.PathTooLongException</td>
			<td>Cette erreur se produit lorsque le chemin vers fichier spécifié dans le paramètre <i>"Nom complet du fichier à créer"</i> dépasse la capacité système (256 caractères).</td>
			<td>Pour corriger cette erreur, vérifiez que le chemin vers le fichier à créer ne dépasse pas les 256 caractères (y compris pour les valeurs des variables).</td>
        </tr>
		<tr>
			<td>System.SecurityException<br />ou<br />System.UnauthorizedAccessException</td>
			<td>Cette erreur se produit lorsque la session Windows actuel n'a pas les droits d'utilisateurs nécessaire pour créer le fichier spécifié.</td>
			<td>Pour corriger cette erreur, démarrez votre logiciel en mode Administrateur.</td>
        </tr>
	</table>

	<p class="title">Caractéristiques</p>
	<table>
		<tr>
			<th>Caractères</th>
			<th>Informations</th>
		</tr>
		<tr>
			<td>Niveau requis</td>
			<td>Confirmé</td>
		</tr>   
		<tr class="bg">
			<td>Catégorie</td>
			<td>Sérialisation</td>
		</tr>
		<tr>
			<td>Type de valeur retourné</td>
			<td>Vrai/Faux (<a href="http://msdn.microsoft.com/fr-fr/library/system.boolean%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">Boolean</a>)</td>
		</tr>
		<tr class="bg">
			<td>Fonctionne dans les fonctions</td>
			<td>Oui</td>
		</tr>
		<tr>
			<td>Fonctionne dans la zone de déclaration</td>
			<td>Non</td>
		</tr>
		<tr class="bg">
			<td>Peut recevoir des actions enfants</td>
			<td>Non</td>
		</tr> 
	</table>

</body>
</html>
