<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Action : Obtenir la taille d'un fichier</title>
	<script type="text/javascript" src="../../../shCore.js"></script>
	<script type="text/javascript" src="../../../shBrushVb.js"></script>
	<link type="text/css" rel="stylesheet" href="../../../shCoreDefault.css"/>
	<link type="text/css" rel="stylesheet" href="../../../style.css"/>
	<script type="text/javascript">SyntaxHighlighter.all();</script>
</head>

<body>

<p class="title">Action : Obtenir la taille d'un fichier</p>
	<p>Cette action permet de récupérer la taille d'un fichier dans un format spécifié.</p>
    <p class="msg_info"><b>Information :</b> Pour vérifier que le fichier existe, utilisez l'action <a href="Déterminer si un fichier existe.html" target="_blank">Déterminer si un fichier existe</a>.</p>
	
	<p class="title">Paramètres</p>
	<table>
		<tr>
			<th>Paramètres</th>
			<th>Descriptions</th>
		</tr>
		<tr>
			<td>Nom complet du fichier</td>
			<td>Doit être égale au chemin complet du fichier dont il faut récupérer la taille.</td>
		</tr>  
		<tr class="bg">
			<td>Ajouter l'unité après la valeur</td>
			<td>En cochant ce paramètre, l'unité de la taille (octet, kilo octet, méga octet ou giga octet) sera ajouté à la suite de la taille.<br />Exemple : 2,49 Go</td>
		</tr> 
		<tr>
			<td>Obtenir la taille dans un format spécifique</td>
			<td>Si ce paramètre est décoché, la valeur retourné sera la taille du fichier en Octet.<br />S'il est coché, vous pourrez choisir de récupérer la taille du fichier dans le format de votre choix, ou bien de laisser l'ordinateur choisir le format en fonction de la taille du fichier. Par exemple, si le fichier fait plusieurs méga octets, mais est inférieur à un giga octet, alors l'ordinateur choisira l'unité <i>"méga octets"</i> automatiquement.</td>
		</tr>  
		<tr class="bg">
			<td>Variable recevant le résultat</td>
			<td>Doit être égale à la variable (non tableau) qui sera égale à la taille du fichier spécifié.</td>
		</tr>
	</table>
	<p class="msg_warning"><b>Erreur à ne pas commettre :</b> Pour le paramètre <i>"Nom complet du fichier"</i>, vous ne pouvez pas utiliser des ressources du projet de type Image et de type Autre. Seule des ressources de type Texte peuvent être utilisées.</p>
	<p class="msg_warning"><b>Erreur à ne pas commettre :</b> Si vous utilisez des variables dans le paramètre <i>"Nom complet du fichier"</i>, assurez-vous que le type de la valeur de chacune de ces variables soit du texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>), ou bien une valeur de type numérique (<a href="http://msdn.microsoft.com/fr-fr/library/06bkb8w2.aspx" target="_blank" title="Lien vers MSDN">Integer</a>, <a href="http://msdn.microsoft.com/fr-fr/library/system.decimal.aspx" target="_blank" title="Lien vers MSDN">Decimal</a>, <a href="http://msdn.microsoft.com/fr-fr/library/system.double.aspx" target="_blank" title="Lien vers MSDN">Double</a>). En effet, seul du texte peut être utilisé dans ce paramètre.<br />
	<b>Note :</b> Pour vérifier le type d'une valeur, utilisez l'action <a href="Obtenir le type d'une variable.html" target="_blank">Obtenir le type d'une variable</a>, dans la catégorie Variables.</p>

	<p class="title">Valeur retournée</p>    
	<p>La valeur retourné est déterminé par la taille du fichier spécifié. Cette valeur est assignée à la variable spécifiée dans le paramètre <i>"Variable recevant le résultat"</i>. Cette valeur est de type texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>).<br />
    Si le paramètre <i>"Ajouter l'unité après la valeur"</i> ets coché, la taille sera suivie de l'unité de celle-ci, à savoir :</p>
    <table>
		<tr>
			<th>Unité</th>
			<th>Texte ajouté à la valeur</th>
		</tr>
		<tr>
			<td>Octets</td>
			<td>Octets</td>
		</tr>
		<tr class="bg">
			<td>Kilo Octets</td>
			<td>Ko</td>
		</tr>
		<tr>
			<td>Méga Octets</td>
			<td>Mo</td>
		</tr> 
		<tr class="bg">
			<td>Giga Octets et plus</td>
			<td>Go</td>
		</tr>
	</table>
	
	<p class="title">Code Visual Basic.Net généré par SoftwareZator</p>
    <p>Code généré si les paramètres <i>"Ajouter l'unité après la valeur"</i> et <i>"Obtenir la taille dans un format spécifique"</i> sont cochés et que l'unité choisie est <i>"Laisser choisir automatiquement"</i></p>
	<pre class="brush: vbnet; toolbar: false;">
Votre_Variable = VelerSoftware_GeneralPlugin.GetFileLen("C:\Votre fichier.txt", True, True, "Auto")

	</pre>   
    <p>Code généré si le paramètre <i>"Obtenir la taille dans un format spécifique"</i> sont cochés et que l'unité choisie est <i>"Mo"</i></p>
	<pre class="brush: vbnet; toolbar: false;">
Votre_Variable = VelerSoftware_GeneralPlugin.GetFileLen("C:\Votre fichier.txt", False, True, "Mo")

	</pre>

	<a id="debug" class="debug"></a><p class="title">Erreurs d'exécutions</p>
    <p>Il arrive qu'un programme informatique rencontre un problème durant son exécution. Souvent, un message d'erreur est alors affiché. Le tableau ci-dessous vous permet de déterminer pourquoi l'erreur que vous rencontrez s'affiche et comment la corriger :</p>
	<table>
		<tr>
			<th>Types d'erreurs</th>
			<th>Descriptions</th>
			<th>Resolutions</th>
		</tr>
		<tr>
			<td>System.InvalidCastException</td>
			<td>Cette erreur se produit lorsque la valeur du paramètre <i>"Nom complet du fichier"</i> n'est pas du texte. Souvent, le problème est causé par une variable utilisé dans ce paramètre et qui a une valeur autre que du texte.</td>
			<td>Pour corriger cette erreur, vérifiez que toutes les valeurs impliquées dans ce paramètre sont bien de type Texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>) et faites les modifications nécessaires pour que ces valeurs soit du texte. Pour cela, utilisez les actions <a href="Obtenir le type d'une variable.html" target="_blank">Obtenir le type d'une variable</a>, <a href="Convertir la valeur d'une variable.html" target="_blank">Convertir la valeur d'une variable</a></td>
        </tr>
		<tr class="bg">
			<td>System.ArgumentException<br />ou<br />System.NotSupportedException</td>
			<td>Cette erreur se produit lorsque la valeur du paramètre <i>"Nom complet du fichier"</i> est nulle, ou contient le signe deux-points (:) ou une barre oblique (\ ou /). C'est caractères ne peuvent être utilisés que pour spécifier un disque dur et un fichier (C:\Un fichier\), mais en aucun cas pour le <u>nom</u> d'un fichier ou dossier.</td>
			<td>Pour corriger cette erreur, vérifiez que le nom du fichier ne soit pas vide et ne contient pas le signe deux-points (:) ou une barre oblique (\ ou /).</td>
        </tr>
		<tr>
			<td>System.ArgumentNullException</td>
			<td>Cette erreur se produit lorsque la valeur du paramètre <i>"Nom complet du fichier"</i> est vide. Pour obtenir l'extension d'un fichier, vous devez impérativement spécifier le chemin complet du fichier concerné.</td>
			<td>Pour corriger cette erreur, vérifiez que ce paramètre ne soit pas vide.</td>
        </tr>
		<tr class="bg">
			<td>System.IO.FileNotFoundException</td>
			<td>Cette erreur se produit lorsque le chemin spécifié dans le paramètre <i>"Nom complet du fichier"</i> est introuvable sur le disque dur. C'est-à-dire, que le fichier n'existe pas à l'emplacement spécifié.</td>
			<td>Pour corriger cette erreur, vérifiez que le chemin vers le fichier soit correcte, et vérifiez que celui-ci existe avec l'action <a href="Déterminer si un fichier existe.html" target="_blank">Déterminer si un fichier existe</a>.</td>
        </tr> 
		<tr>
			<td>System.SecurityException<br />ou<br />System.UnauthorizedAccessException</td>
			<td>Cette erreur se produit lorsque la session Windows actuel n'a pas les droits d'utilisateurs nécessaire pour obtenir l'extension du fichier spécifié.</td>
			<td>Pour corriger cette erreur, démarrez votre logiciel en mode Administrateur.</td>
        </tr>
		<tr class="bg">
			<td>System.IO.PathTooLongException</td>
			<td>Cette erreur se produit lorsque le chemin vers fichier spécifié dans le paramètre <i>"Nom complet du fichier"</i> dépasse la capacité système (256 caractères).</td>
			<td>Pour corriger cette erreur, vérifiez que le chemin vers le fichier ne dépasse pas les 256 caractères (y compris pour les valeurs des variables).</td>
        </tr>
	</table>

	<p class="title">Caractéristiques</p>
	<table>
		<tr>
			<th>Caractères</th>
			<th>Informations</th>
		</tr>
		<tr>
			<td>Niveau requis</td>
			<td>Débutant</td>
		</tr>   
		<tr class="bg">
			<td>Catégorie</td>
			<td>Fichiers</td>
		</tr>
		<tr>
			<td>Type de valeur retourné</td>
			<td>Texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>)</td>
		</tr>
		<tr class="bg">
			<td>Fonctionne dans les fonctions</td>
			<td>Oui</td>
		</tr>
		<tr>
			<td>Fonctionne dans la zone de déclaration</td>
			<td>Non</td>
		</tr>
		<tr class="bg">
			<td>Peut recevoir des actions enfants</td>
			<td>Non</td>
		</tr> 
	</table>

</body>
</html>
