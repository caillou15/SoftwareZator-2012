<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Action : Envoyer un email</title>
	<script type="text/javascript" src="../../../shCore.js"></script>
	<script type="text/javascript" src="../../../shBrushVb.js"></script>
	<link type="text/css" rel="stylesheet" href="../../../shCoreDefault.css"/>
	<link type="text/css" rel="stylesheet" href="../../../style.css"/>
	<script type="text/javascript">SyntaxHighlighter.all();</script>
</head>

<body>

<p class="title">Action : Envoyer un email</p>
	<p>Cette action va vous permettre d'envoyer un courrier eléctronique depuis votre ordinateur.</p>

	<p class="title">Paramètres</p>
	<table>
		<tr>
			<th>Paramètres</th>
			<th>Descriptions</th>
		</tr>
		<tr>
			<td>Adresse email de l'expéditeur</td>
			<td>Doit être égale à l'adresse email de celui qui envoie le message.</td>
		</tr>
		<tr class="bg">
			<td>Adresse email du destinataire</td>
			<td>Doit être égale à l'adresse email de la personne à qui le message sera envoyé.</td>
		</tr>
		<tr>
			<td>Serveur SMTP</td>
			<td>Doit être égale au serveur de courrier sortant (SMTP). En général, il est écrit de cette manière : <i>"smtp.domaine.com"</i> avec "domaine.com" comme étant le nom de domaine de l'adresse email de l'expéditeur ou du fournisseur d'accès internet (FAI) de l'ordinateur sur lequel le programme fonctionne.<br />Exemple : pour une adresse Google Mail (Gmail), si l'adresse de l'expéditeur est <i>"nom@gmail.com"</i>, le serveur SMTP sera <i>"smtp.gmail.com"</i>. En revanche, si l'adresse email de l'expéditeur est par exemple <i>"nom@hotmail.net"</i> et que le FAI est <i>"Orange"</i>, le serveur SMTP sera <i>"smtp.orange.fr"</i>.<br />Tout dépend donc de l'adresse de l'expéditeur et du FAI. Pour déterminer quel SMTP vous devez utiliser, il est conseiller de chercher dans un premier temps, sur internet, le SMTP lié à l'adresse de l'expéditeur, puis, si celui-ci ne fonctionne pas, chercher le SMTP du FAI.</td>
		</tr>
		<tr class="bg">
			<td>Sujet du message</td>
			<td>Permet de saisir le sujet de l'email à envoyer.</td>
		</tr> 
		<tr>
			<td>Texte du message</td>
			<td>Doit être égale au texte que vous voulez envoyer par email.</td>
		</tr> 
		<tr class="bg">
			<td>Fichier en pièce jointe (facultatif)</td>
			<td>Permet de saisir un fichier qui sera envoyé en pièce jointe.</td>
		</tr> 
		<tr>
			<td>Nom d'utilisateur (facultatif)</td>
			<td>Permet de saisir le nom d'utiliseur utilisé pour envoyer le message. Laissez vide pour ne pas en utiliser.<br />Remarque : il arrive régulièrement que l'envoi d'e-mail échoue car ce paramètre est vide.</td>
		</tr> 
		<tr class="bg">
			<td>Mot de passe (facultatif)</td>
			<td>Si un nom d'utilisateur a été indiqué, vous devez également saisir son mot de passe dans ce paramètre.</td>
		</tr> 
		<tr>
			<td>Variable recevant le résultat (facultatif)</td>
			<td>Doit être égale à la variable (non tableau) recevant le résultat de l'envoi.</td>
		</tr>  
	</table>
	<p class="msg_warning"><b>Erreur à ne pas commettre :</b> Pour les paramètres <i>"Adresse email de l'expéditeur"</i>, <i>"Adresse email du destinataire"</i>, <i>"Serveur SMTP"</i>, <i>"Sujet du message"</i>, <i>"Texte du message"</i>, <i>"Fichier en pièce jointe"</i>, <i>"Nom d'utilisateur"</i> et <i>"Mot de passe"</i>, vous ne pouvez pas utiliser des ressources du projet de type Image et de type Autre. Seule des ressources de type Texte peuvent être utilisées.</p>
	<p class="msg_warning"><b>Erreur à ne pas commettre :</b> Si vous utilisez dans variables dans les paramètres <i>"Adresse email de l'expéditeur"</i>, <i>"Adresse email du destinataire"</i>, <i>"Serveur SMTP"</i>, <i>"Sujet du message"</i>, <i>"Texte du message"</i>, <i>"Fichier en pièce jointe"</i>, <i>"Nom d'utilisateur"</i> et <i>"Mot de passe"</i>, assurez-vous que le type de la valeur de chacune de ces variables soit du texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>), ou bien une valeur de type numérique (<a href="http://msdn.microsoft.com/fr-fr/library/06bkb8w2.aspx" target="_blank" title="Lien vers MSDN">Integer</a>, <a href="http://msdn.microsoft.com/fr-fr/library/system.decimal.aspx" target="_blank" title="Lien vers MSDN">Decimal</a>, <a href="http://msdn.microsoft.com/fr-fr/library/system.double.aspx" target="_blank" title="Lien vers MSDN">Double</a>). En effet, seul du texte peut être utilisé dans ces paramètres.<br />
	<b>Note :</b> Pour vérifier le type d'une valeur, utilisez l'action <a href="Obtenir le type d'une variable.html" target="_blank">Obtenir le type d'une variable</a>, dans la catégorie Variables.</p>

	<p class="title">Valeur retournée</p>
	<p>La valeur retournée est déterminée par la réussite de l'envoi ou non. Elle sera enregistrée dans la variable définit dans le paramètre <i>"Variable recevant le résultat"</i>. Cette valeur est de type texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>).</p>
	<table>
		<tr>
			<th>Etat de l'envoi</th>
			<th>Valeurs retournées</th>
		</tr>
		<tr>
			<td>Réussi</td>
			<td>1</td>
		</tr>
		<tr class="bg">
			<td>Echoué</td>
			<td>Sending email failed : "Le Message d'Erreur"</td>
		</tr>
	</table>

	<p class="title">Code Visual Basic.Net généré par SoftwareZator</p>
	<pre class="brush: vbnet; toolbar: false;">
Votre_Variable = VelerSoftware_GeneralPlugin.Envoyer_Email("Expéditeur", "Destinataire", "SMTP", "Sujet", "Message", "Pièce jointe", "Utilisateur", "Mot de passe")

	</pre>

	<a id="debug" class="debug"></a><p class="title">Erreurs d'exécutions</p>
    <p>Il arrive qu'un programme informatique rencontre un problème durant son exécution. Souvent, un message d'erreur est alors affiché. Le tableau ci-dessous vous permet de déterminer pourquoi l'erreur que vous rencontrez s'affiche et comment la corriger :</p>
	<table>
		<tr>
			<th>Types d'erreurs</th>
			<th>Descriptions</th>
			<th>Resolutions</th>
		</tr>
		<tr>
			<td>System.ArgumentException<br />ou<br />System.InvalidCastException</td>
			<td>Cette erreur se produit lorsque la valeur du paramètre <i>"Adresse email de l'expéditeur"</i>, <i>"Adresse email du destinataire"</i>, <i>"Serveur SMTP"</i>, <i>"Sujet du message"</i>, <i>"Texte du message"</i>, <i>"Fichier en pièce jointe"</i>, <i>"Nom d'utilisateur"</i> et ou <i>"Mot de passe"</i> ne sont pas du texte. Souvent, le problème est causé par une variable utilisé dans ces paramètres et qui ont une valeur autre que du texte.</td>
			<td>Pour corriger cette erreur, vérifiez que toutes les valeurs impliquées dans ces paramètres sont bien de type Texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>) et faites les modifications nécessaires pour que ces valeurs soit du texte. Pour cela, utilisez les actions <a href="Obtenir le type d'une variable.html" target="_blank">Obtenir le type d'une variable</a>, <a href="Convertir la valeur d'une variable.html" target="_blank">Convertir la valeur d'une variable</a></td>
        </tr>
	</table>

	<p class="title">Caractéristiques</p>
	<table>
		<tr>
			<th>Caractères</th>
			<th>Informations</th>
		</tr>
		<tr>
			<td>Niveau requis</td>
			<td>Novice</td>
		</tr>   
		<tr class="bg">
			<td>Catégorie</td>
			<td>Internet</td>
		</tr>
		<tr>
			<td>Type de valeur retourné</td>
			<td>Texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>)</td>
		</tr>
		<tr class="bg">
			<td>Fonctionne dans les fonctions</td>
			<td>Oui</td>
		</tr>
		<tr>
			<td>Fonctionne dans la zone de déclaration</td>
			<td>Non</td>
		</tr>
		<tr class="bg">
			<td>Peut recevoir des actions enfants</td>
			<td>Non</td>
		</tr> 
	</table>

</body>
</html>
