<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Action : Obtenir la liste des fichiers ou dossiers d'un répertoire</title>
	<script type="text/javascript" src="../../../shCore.js"></script>
	<script type="text/javascript" src="../../../shBrushVb.js"></script>
	<link type="text/css" rel="stylesheet" href="../../../shCoreDefault.css"/>
	<link type="text/css" rel="stylesheet" href="../../../style.css"/>
	<script type="text/javascript">SyntaxHighlighter.all();</script>
</head>

<body>

<p class="title">Action : Obtenir la liste des fichiers ou dossiers d'un répertoire</p>
	<p>Cette action permet de récupérer ou recherche une liste de fichiers ou de dossiers dans un répertoire spécifié.</p>
	
	<p class="title">Paramètres</p>
	<table>
		<tr>
			<th>Paramètres</th>
			<th>Descriptions</th>
		</tr>
		<tr>
			<td>Répertoire depuis lequel il faut chercher des fichiers ou dossiers</td>
			<td>Doit être égale au chemin complet du dossier à partir duquel la recherche de fichier ou dossiers sera effectué.</td>
		</tr>  
		<tr class="bg">
			<td>Options de recherche</td>
			<td>Défini le mode de recherche :<ul><li>Rechercher uniquement dans le dossier spécifié ci-dessus : l'action récupèrera alors tous les documents qui se trouve dans le dossier spécifié, sans prendre en compte les sous-dossiers.</li><li>Rechercher dans le dossier de recherche et les sous-dossiers : l'action récupèrera alors tous les documents qui se trouve dans le dossier spécifié y compris ceux qui se trouvent dans les sous-dossiers.</li></ul></td>
		</tr>
		<tr>
			<td>Type de recherche</td>
			<td>Défini type de document à rechercher :<ul><li>Rechercher des fichiers.</li><li>Rechercher des dossiers.</li></ul></td>
		</tr>
		<tr class="bg">
			<td>Obtenir uniquement les fichiers/dossiers ayant le texte suivant dans leur nom</td>
			<td>Ce paramètre permet de préciser que l'action doit récupérer tous les fichiers contenant dans leur nom, le texte spécifié. Ci-dessous quelques exemples :
            <ul><li>Si vous indiquez <i>"ABC"</i>, l'action retourne la liste de tous les fichiers/dossiers contant le texte <i>"ABC"</i> dans leur nom.</li><li>Si vous indiquez <i>"*.txt"</i>, l'action retournera la liste de tous les fichiers ayant pour extension <i>".txt"</i>, autrement dit, tous les fichiers de type Texte.</li><li>Si vous indiquez <i>"*.*"</i> ou <i>"*"</i>, l'action retournera tous les fichiers/dossier quelque soit leur nom.</li></ul></td>
		</tr> 
		<tr>
			<td>Variable tableau recevant le résultat</td>
			<td>Doit être égale à la variable tableau qui sera égale à la liste des fichiers ou dossiers récupérés.</td>
		</tr>
	</table>
	<p class="msg_warning"><b>Erreur à ne pas commettre :</b> Pour les paramètres <i>"Répertoire depuis lequel il faut chercher des fichiers ou dossiers"</i> et <i>"Obtenir uniquement les fichiers/dossiers ayant le texte suivant dans leur nom"</i>, vous ne pouvez pas utiliser des ressources du projet de type Image et de type Autre. Seule des ressources de type Texte peuvent être utilisées.</p>
	<p class="msg_warning"><b>Erreur à ne pas commettre :</b> Si vous utilisez dans variables dans les paramètres <i>"Répertoire depuis lequel il faut chercher des fichiers ou dossiers"</i> et <i>"Obtenir uniquement les fichiers/dossiers ayant le texte suivant dans leur nom"</i>, assurez-vous que le type de la valeur de chacune de ces variables soit du texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>), ou bien une valeur de type numérique (<a href="http://msdn.microsoft.com/fr-fr/library/06bkb8w2.aspx" target="_blank" title="Lien vers MSDN">Integer</a>, <a href="http://msdn.microsoft.com/fr-fr/library/system.decimal.aspx" target="_blank" title="Lien vers MSDN">Decimal</a>, <a href="http://msdn.microsoft.com/fr-fr/library/system.double.aspx" target="_blank" title="Lien vers MSDN">Double</a>). En effet, seul du texte peut être utilisé dans ces paramètres.<br />
	<b>Note :</b> Pour vérifier le type d'une valeur, utilisez l'action <a href="Obtenir le type d'une variable.html" target="_blank">Obtenir le type d'une variable</a>, dans la catégorie Variables.</p>

	<p class="title">Valeur retournée</p>
	<p>La valeur retournée est un tableau de valeur. Cette valeur est de type texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>). Elle est égale à l'ensembles des chemins et noms des fichiers ou dossiers ayant été récupérés par l'action.</p>

	<p class="title">Code Visual Basic.Net généré par SoftwareZator</p>
    <p>Code généré si l'action doit récupérer la liste des <i>"fichiers"</i> dans le dossier spécifié, et ses sous-dossiers, et qu'elle doit récupérer tous les fichiers de type Texte (avec l'extension .txt) :</p>
	<pre class="brush: vbnet; toolbar: false;">
Votre_variable_Tableau = New System.Collections.Generic.List(Of Object)(System.IO.Directory.GetFiles("C:\Dossier de recherche\", "*.txt", System.IO.SearchOption.AllDirectories))

	</pre>

	<a id="debug" class="debug"></a><p class="title">Erreurs d'exécutions</p>
    <p>Il arrive qu'un programme informatique rencontre un problème durant son exécution. Souvent, un message d'erreur est alors affiché. Le tableau ci-dessous vous permet de déterminer pourquoi l'erreur que vous rencontrez s'affiche et comment la corriger :</p>
	<table>
		<tr>
			<th>Types d'erreurs</th>
			<th>Descriptions</th>
			<th>Resolutions</th>
		</tr>
		<tr>
			<td>System.InvalidCastException</td>
			<td>Cette erreur se produit lorsque la valeur du paramètre <i>"Répertoire depuis lequel il faut chercher des fichiers ou dossiers"</i> et ou <i>"Obtenir uniquement les fichiers/dossiers ayant le texte suivant dans leur nom"</i> ne sont pas du texte. Souvent, le problème est causé par une variable utilisé dans ces paramètres et qui ont une valeur autre que du texte.</td>
			<td>Pour corriger cette erreur, vérifiez que toutes les valeurs impliquées dans ces paramètres sont bien de type Texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>) et faites les modifications nécessaires pour que ces valeurs soit du texte. Pour cela, utilisez les actions <a href="Obtenir le type d'une variable.html" target="_blank">Obtenir le type d'une variable</a>, <a href="Convertir la valeur d'une variable.html" target="_blank">Convertir la valeur d'une variable</a></td>
        </tr>
		<tr class="bg">
			<td>System.ArgumentNullException</td>
			<td>Cette erreur se produit lorsque la valeur du paramètre <i>"Répertoire depuis lequel il faut chercher des fichiers ou dossiers"</i> est vide. Pour créer un fichier, vous devez impérativement spécifier le chemin complet du dossier de recherche.</td>
			<td>Pour corriger cette erreur, vérifiez que ce paramètre ne soit pas vide.</td>
        </tr>
		<tr>
			<td>System.IO.DirectoryNotFoundException<br />ou<br />System.IO.FileNotFoundException</td>
			<td>Cette erreur se produit lorsque le chemin spécifié dans le paramètre <i>"Répertoire depuis lequel il faut chercher des fichiers ou dossiers"</i> est introuvable sur le disque dur. C'est-à-dire, que le dossier spécifié dans le premier paramètre de l'action n'existe pas.</td>
			<td>Pour corriger cette erreur, vérifiez que le dossier existe avec l'action <a href="Déterminer si un dossier existe.html" target="_blank">Déterminer si un dossier existe</a>.</td>
        </tr>
		<tr class="bg">
			<td>System.IO.IOException</td>
			<td>Cette erreur se produit lorsque le dossier spécifié dans le paramètre <i>"Répertoire depuis lequel il faut chercher des fichiers ou dossiers"</i> est en réalité un fichier. Vous ne pouvez pas recherche des documents dans un fichier, mais uniquement dans un dossier.</td>
			<td>Pour corriger cette erreur, vérifiez que le dossier existe avec l'action <a href="Déterminer si un dossier existe.html" target="_blank">Déterminer si un dossier existe</a>.</td>
        </tr>
		<tr>
			<td>System.IO.PathTooLongException</td>
			<td>Cette erreur se produit lorsque le chemin vers dossier spécifié dans le paramètre <i>"Répertoire depuis lequel il faut chercher des fichiers ou dossiers"</i> dépasse la capacité système (256 caractères).</td>
			<td>Pour corriger cette erreur, vérifiez que le chemin vers le dossier ne dépasse pas les 256 caractères (y compris pour les valeurs des variables).</td>
        </tr>
		<tr class="bg">
			<td>System.SecurityException<br />ou<br />System.UnauthorizedAccessException</td>
			<td>Cette erreur se produit lorsque la session Windows actuel n'a pas les droits d'utilisateurs nécessaire pour effectuer une recherche dans le dossier spécifié.</td>
			<td>Pour corriger cette erreur, démarrez votre logiciel en mode Administrateur.</td>
        </tr>
	</table>

	<p class="title">Caractéristiques</p>
	<table>
		<tr>
			<th>Caractères</th>
			<th>Informations</th>
		</tr>
		<tr>
			<td>Niveau requis</td>
			<td>Avancé</td>
		</tr>   
		<tr class="bg">
			<td>Catégorie</td>
			<td>Fichiers</td>
		</tr>
		<tr>
			<td>Type de valeur retourné</td>
			<td>Liste de valeurs texte (<a href="http://msdn.microsoft.com/fr-fr/library/system.string%28v=VS.100%29.aspx" target="_blank" title="Lien vers MSDN">String</a>)</td>
		</tr>
		<tr class="bg">
			<td>Fonctionne dans les fonctions</td>
			<td>Oui</td>
		</tr>
		<tr>
			<td>Fonctionne dans la zone de déclaration</td>
			<td>Non</td>
		</tr>
		<tr class="bg">
			<td>Peut recevoir des actions enfants</td>
			<td>Non</td>
		</tr> 
	</table>

</body>
</html>
